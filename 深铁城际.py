import tkinter as tk
from tkinter import ttk, scrolledtext, messagebox

class ShenzhenIntercityQuery:
    """æ·±åœ³éƒ½å¸‚åœˆåŸé™…é“è·¯é‡Œç¨‹æŸ¥è¯¢ä¸ç¥¨ä»·è®¡ç®—GUIç±»ï¼ˆæœ€ç»ˆä¿®å¤ç‰ˆï¼‰"""
    
    def __init__(self, root: tk.Tk):
        # åˆå§‹åŒ–ä¸»çª—å£
        self.root = root
        self.root.title("æ·±åœ³éƒ½å¸‚åœˆåŸé™…é“è·¯é‡Œç¨‹æŸ¥è¯¢ç³»ç»Ÿ")
        self.root.geometry("750x520")
        self.root.resizable(False, False)
        
        # æ ¸å¿ƒæ•°æ®ï¼šé‡Œç¨‹å­—å…¸ï¼ˆå•ä½ï¼šå…¬é‡Œï¼‰
        self.station_distances: dict[str, dict[str, float]] = self._load_station_distances()
        
        # çº¿è·¯-ç«™ç‚¹æ˜ å°„ï¼ˆæŒ‰å®é™…è¿è¥çº¿è·¯åˆ†ç±»ï¼‰
        self.lines = {
            "æ·±å¤§åŸé™…": ["æœºåœºåŒ—", "æœºåœºä¸œ", "é»„éº»å¸ƒ", "çŸ³å²©", "é¾™èƒœ", "æ°‘æ²»åŒ—", "äº”å’Œ", "ç™½æ³¥å‘", "å¤§è¿", "åªå±±", "èšé¾™"],
            "æ·±æƒ åŸé™…": ["å‰ä¿", "æ€¡æµ·", "é²¤é±¼é—¨", "è¥¿ä¸½", "æ·±åœ³åŒ—", "äº”å’Œ", "å¹³æ¹–", "å‡¤å²—", "å¤§è¿åŒ—", "é¾™åŸ", "åªåœ°"],
            "é¾™å¤§åŸé™…ï¼ˆå¤§é¹æ”¯çº¿ï¼‰": ["é¾™åŸ", "åªå±±", "ç‡•å­æ¹–", "è‘µæ¶Œ", "å¤§é¹", "æ–°å¤§"],
            "å…¨éƒ¨åŸé™…":["æœºåœºåŒ—", "æœºåœºä¸œ", "é»„éº»å¸ƒ", "çŸ³å²©", "é¾™èƒœ", "æ°‘æ²»åŒ—", "äº”å’Œ", "ç™½æ³¥å‘", "å¤§è¿", "åªå±±", "èšé¾™", "å‰ä¿", "æ€¡æµ·", "é²¤é±¼é—¨", "è¥¿ä¸½", "æ·±åœ³åŒ—", "å¹³æ¹–", "å‡¤å²—", "å¤§è¿åŒ—", "é¾™åŸ", "åªåœ°", "ç‡•å­æ¹–", "è‘µæ¶Œ", "å¤§é¹", "æ–°å¤§"]
        }
        
        # ç¥¨ä»·æ ‡å‡†ï¼ˆæ”¯æŒè®¾ç½®ä¿®æ”¹ï¼Œåˆå§‹é»˜è®¤å€¼ï¼‰
        self.fare_standards = [
            {"rate": 0.45, "min_fare": 4, "desc": "0.45å…ƒ/å…¬é‡Œï¼ˆæœ€ä½4å…ƒï¼‰"},
            {"rate": 0.59, "min_fare": 5, "desc": "0.59å…ƒ/å…¬é‡Œï¼ˆæœ€ä½5å…ƒï¼‰"}
        ]
        
        # åˆå§‹åŒ–å˜é‡
        self.start_line_var = tk.StringVar()  # èµ·ç‚¹çº¿è·¯å˜é‡
        self.end_line_var = tk.StringVar()    # ç»ˆç‚¹çº¿è·¯å˜é‡
        self.start_var = tk.StringVar()       # èµ·ç‚¹ç«™å˜é‡
        self.end_var = tk.StringVar()         # ç»ˆç‚¹ç«™å˜é‡
        
        # æ„å»ºGUIç•Œé¢
        self._setup_ui()
    
    def _load_station_distances(self) -> dict[str, dict[str, float]]:
        """åŠ è½½é‡Œç¨‹æ•°æ®ï¼ˆä¿æŒåŸæœ‰æ•°æ®ä¸å˜ï¼‰"""
        return {
            "æœºåœºåŒ—": {
                "æœºåœºåŒ—": 0.00, "æœºåœºä¸œ": 3.01, "é»„éº»å¸ƒ": 8.78, "çŸ³å²©": 16.89, "é¾™èƒœ": 26.06, "æ°‘æ²»åŒ—": 28.89, 
                "äº”å’Œ": 31.56, "ç™½æ³¥å‘": 41.91, "å¤§è¿": 50.67, "åªå±±": 61.41, "èšé¾™": 67.79,
                "å‰ä¿": 57.49, "æ€¡æµ·": 55.29, "é²¤é±¼é—¨": 53.32, "è¥¿ä¸½": 46.83, "æ·±åœ³åŒ—": 35.43, 
                "å¹³æ¹–": 41.99, "å‡¤å²—": 46.59, "å¤§è¿åŒ—": 52.08, "é¾™åŸ": 56.13, "åªåœ°": 63.62,
                "ç‡•å­æ¹–": 67.46, "è‘µæ¶Œ": 73.69, "å¤§é¹": 81.01, "æ–°å¤§": 88.60
            },
            "æœºåœºä¸œ": {
                "æœºåœºåŒ—": 3.01, "æœºåœºä¸œ": 0.00, "é»„éº»å¸ƒ": 5.77, "çŸ³å²©": 13.88, "é¾™èƒœ": 23.06, "æ°‘æ²»åŒ—": 25.88, 
                "äº”å’Œ": 28.56, "ç™½æ³¥å‘": 38.91, "å¤§è¿": 47.66, "åªå±±": 58.40, "èšé¾™": 64.78,
                "å‰ä¿": 54.48, "æ€¡æµ·": 52.29, "é²¤é±¼é—¨": 50.31, "è¥¿ä¸½": 43.83, "æ·±åœ³åŒ—": 32.42, 
                "å¹³æ¹–": 38.98, "å‡¤å²—": 43.59, "å¤§è¿åŒ—": 49.07, "é¾™åŸ": 53.13, "åªåœ°": 60.61,
                "ç‡•å­æ¹–": 64.46, "è‘µæ¶Œ": 70.69, "å¤§é¹": 78.00, "æ–°å¤§": 85.59
            },
            "é»„éº»å¸ƒ": {
                "æœºåœºåŒ—": 8.78, "æœºåœºä¸œ": 5.77, "é»„éº»å¸ƒ": 0.00, "çŸ³å²©": 8.11, "é¾™èƒœ": 17.28, "æ°‘æ²»åŒ—": 20.11, 
                "äº”å’Œ": 22.78, "ç™½æ³¥å‘": 33.14, "å¤§è¿": 41.89, "åªå±±": 52.63, "èšé¾™": 59.01,
                "å‰ä¿": 48.71, "æ€¡æµ·": 46.51, "é²¤é±¼é—¨": 44.54, "è¥¿ä¸½": 38.05, "æ·±åœ³åŒ—": 26.65, 
                "å¹³æ¹–": 22.78, "å‡¤å²—": 33.21, "å¤§è¿åŒ—": 37.81, "é¾™åŸ": 43.30, "åªåœ°": 54.84,
                "ç‡•å­æ¹–": 47.35, "è‘µæ¶Œ": 52.63, "å¤§é¹": 58.69, "æ–°å¤§": 64.92
            },
            "çŸ³å²©": {
                "æœºåœºåŒ—": 16.89, "æœºåœºä¸œ": 13.88, "é»„éº»å¸ƒ": 8.11, "çŸ³å²©": 0.00, "é¾™èƒœ": 9.17, "æ°‘æ²»åŒ—": 12.00, 
                "äº”å’Œ": 14.67, "ç™½æ³¥å‘": 25.02, "å¤§è¿": 33.78, "åªå±±": 44.52, "èšé¾™": 50.90,
                "å‰ä¿": 40.59, "æ€¡æµ·": 38.40, "é²¤é±¼é—¨": 36.43, "è¥¿ä¸½": 29.94, "æ·±åœ³åŒ—": 18.53, 
                "å¹³æ¹–": 29.70, "å‡¤å²—": 29.70, "å¤§è¿åŒ—": 35.91, "é¾™åŸ": 39.24, "åªåœ°": 47.53,
                "ç‡•å­æ¹–": 36.73, "è‘µæ¶Œ": 44.52, "å¤§é¹": 50.57, "æ–°å¤§": 56.80
            },
            "é¾™èƒœ": {
                "æœºåœºåŒ—": 26.06, "æœºåœºä¸œ": 23.06, "é»„éº»å¸ƒ": 17.28, "çŸ³å²©": 9.17, "é¾™èƒœ": 0.00, "æ°‘æ²»åŒ—": 2.83, 
                "äº”å’Œ": 5.50, "ç™½æ³¥å‘": 15.85, "å¤§è¿": 24.61, "åªå±±": 35.35, "èšé¾™": 41.72,
                "å‰ä¿": 31.42, "æ€¡æµ·": 29.23, "é²¤é±¼é—¨": 27.26, "è¥¿ä¸½": 20.77, "æ·±åœ³åŒ—": 9.36, 
                "å¹³æ¹–": 20.53, "å‡¤å²—": 20.53, "å¤§è¿åŒ—": 26.01, "é¾™åŸ": 29.19, "åªåœ°": 37.47,
                "ç‡•å­æ¹–": 27.24, "è‘µæ¶Œ": 35.35, "å¤§é¹": 41.40, "æ–°å¤§": 47.63
            },
            "æ°‘æ²»åŒ—": {
                "æœºåœºåŒ—": 28.89, "æœºåœºä¸œ": 25.88, "é»„éº»å¸ƒ": 20.11, "çŸ³å²©": 12.00, "é¾™èƒœ": 2.83, "æ°‘æ²»åŒ—": 0.00, 
                "äº”å’Œ": 2.67, "ç™½æ³¥å‘": 13.03, "å¤§è¿": 21.78, "åªå±±": 32.52, "èšé¾™": 38.90,
                "å‰ä¿": 28.60, "æ€¡æµ·": 26.40, "é²¤é±¼é—¨": 24.43, "è¥¿ä¸½": 17.94, "æ·±åœ³åŒ—": 6.54, 
                "å¹³æ¹–": 17.03, "å‡¤å²—": 17.03, "å¤§è¿åŒ—": 23.19, "é¾™åŸ": 27.24, "åªåœ°": 34.73,
                "ç‡•å­æ¹–": 27.24, "è‘µæ¶Œ": 35.35, "å¤§é¹": 41.40, "æ–°å¤§": 47.63
            },
            "äº”å’Œ": {
                "æœºåœºåŒ—": 31.56, "æœºåœºä¸œ": 28.56, "é»„éº»å¸ƒ": 22.78, "çŸ³å²©": 14.67, "é¾™èƒœ": 5.50, "æ°‘æ²»åŒ—": 2.67, 
                "äº”å’Œ": 0.00, "ç™½æ³¥å‘": 10.35, "å¤§è¿": 19.11, "åªå±±": 29.85, "èšé¾™": 36.22,
                "å‰ä¿": 26.92, "æ€¡æµ·": 24.83, "é²¤é±¼é—¨": 22.76, "è¥¿ä¸½": 15.27, "æ·±åœ³åŒ—": 3.86, 
                "å¹³æ¹–": 10.35, "å‡¤å²—": 10.35, "å¤§è¿åŒ—": 20.51, "é¾™åŸ": 24.57, "åªåœ°": 32.06,
                "ç‡•å­æ¹–": 24.57, "è‘µæ¶Œ": 32.52, "å¤§é¹": 38.58, "æ–°å¤§": 44.80
            },
            "ç™½æ³¥å‘": {
                "æœºåœºåŒ—": 41.91, "æœºåœºä¸œ": 38.91, "é»„éº»å¸ƒ": 33.14, "çŸ³å²©": 25.02, "é¾™èƒœ": 15.85, "æ°‘æ²»åŒ—": 13.03, 
                "äº”å’Œ": 10.35, "ç™½æ³¥å‘": 0.00, "å¤§è¿": 8.76, "åªå±±": 19.50, "èšé¾™": 25.87,
                "å‰ä¿": 15.85, "æ€¡æµ·": 13.73, "é²¤é±¼é—¨": 11.66, "è¥¿ä¸½": 5.26, "æ·±åœ³åŒ—": 14.22, 
                "å¹³æ¹–": 19.11, "å‡¤å²—": 25.38, "å¤§è¿åŒ—": 30.87, "é¾™åŸ": 35.92, "åªåœ°": 43.71,
                "ç‡•å­æ¹–": 36.22, "è‘µæ¶Œ": 44.30, "å¤§é¹": 50.36, "æ–°å¤§": 56.69
            },
            "å¤§è¿": {
                "æœºåœºåŒ—": 50.67, "æœºåœºä¸œ": 47.66, "é»„éº»å¸ƒ": 41.89, "çŸ³å²©": 33.78, "é¾™èƒœ": 24.61, "æ°‘æ²»åŒ—": 21.78, 
                "äº”å’Œ": 19.11, "ç™½æ³¥å‘": 8.76, "å¤§è¿": 0.00, "åªå±±": 10.74, "èšé¾™": 17.12,
                "å‰ä¿": 6.38, "æ€¡æµ·": 4.24, "é²¤é±¼é—¨": 2.18, "è¥¿ä¸½": 4.52, "æ·±åœ³åŒ—": 15.03, 
                "å¹³æ¹–": 25.38, "å‡¤å²—": 25.38, "å¤§è¿åŒ—": 30.87, "é¾™åŸ": 35.92, "åªåœ°": 43.71,
                "ç‡•å­æ¹–": 36.22, "è‘µæ¶Œ": 44.30, "å¤§é¹": 50.36, "æ–°å¤§": 56.69
            },
            "åªå±±": {
                "æœºåœºåŒ—": 61.41, "æœºåœºä¸œ": 58.40, "é»„éº»å¸ƒ": 52.63, "çŸ³å²©": 44.52, "é¾™èƒœ": 35.35, "æ°‘æ²»åŒ—": 32.52, 
                "äº”å’Œ": 29.85, "ç™½æ³¥å‘": 19.50, "å¤§è¿": 10.74, "åªå±±": 0.00, "èšé¾™": 6.38,
                "å‰ä¿": 55.77, "æ€¡æµ·": 53.58, "é²¤é±¼é—¨": 51.49, "è¥¿ä¸½": 45.04, "æ·±åœ³åŒ—": 22.97, 
                "å¹³æ¹–": 29.57, "å‡¤å²—": 29.57, "å¤§è¿åŒ—": 35.05, "é¾™åŸ": 40.09, "åªåœ°": 47.88,
                "ç‡•å­æ¹–": 40.23, "è‘µæ¶Œ": 48.31, "å¤§é¹": 54.37, "æ–°å¤§": 60.70
            },
            "èšé¾™": {
                "æœºåœºåŒ—": 67.79, "æœºåœºä¸œ": 64.78, "é»„éº»å¸ƒ": 59.01, "çŸ³å²©": 50.90, "é¾™èƒœ": 41.72, "æ°‘æ²»åŒ—": 38.90, 
                "äº”å’Œ": 36.22, "ç™½æ³¥å‘": 25.87, "å¤§è¿": 17.12, "åªå±±": 6.38, "èšé¾™": 0.00,
                "å‰ä¿": 62.15, "æ€¡æµ·": 59.95, "é²¤é±¼é—¨": 57.98, "è¥¿ä¸½": 51.49, "æ·±åœ³åŒ—": 40.09, 
                "å¹³æ¹–": 36.22, "å‡¤å²—": 29.81, "å¤§è¿åŒ—": 35.35, "é¾™åŸ": 40.39, "åªåœ°": 48.27,
                "ç‡•å­æ¹–": 40.55, "è‘µæ¶Œ": 48.63, "å¤§é¹": 54.69, "æ–°å¤§": 61.02
            },
            "å‰ä¿": {
                "æœºåœºåŒ—": 57.49, "æœºåœºä¸œ": 54.48, "é»„éº»å¸ƒ": 48.71, "çŸ³å²©": 40.59, "é¾™èƒœ": 31.42, "æ°‘æ²»åŒ—": 28.60, 
                "äº”å’Œ": 26.92, "ç™½æ³¥å‘": 15.85, "å¤§è¿": 6.38, "åªå±±": 55.77, "èšé¾™": 62.15,
                "å‰ä¿": 0.00, "æ€¡æµ·": 2.19, "é²¤é±¼é—¨": 4.17, "è¥¿ä¸½": 10.65, "æ·±åœ³åŒ—": 22.06, 
                "å¹³æ¹–": 29.52, "å‡¤å²—": 36.35, "å¤§è¿åŒ—": 40.95, "é¾™åŸ": 46.44, "åªåœ°": 54.09,
                "ç‡•å­æ¹–": 46.33, "è‘µæ¶Œ": 53.80, "å¤§é¹": 59.96, "æ–°å¤§": 66.29
            },
            "æ€¡æµ·": {
                "æœºåœºåŒ—": 55.29, "æœºåœºä¸œ": 52.29, "é»„éº»å¸ƒ": 46.51, "çŸ³å²©": 38.40, "é¾™èƒœ": 29.23, "æ°‘æ²»åŒ—": 26.40, 
                "äº”å’Œ": 24.83, "ç™½æ³¥å‘": 13.73, "å¤§è¿": 4.24, "åªå±±": 53.58, "èšé¾™": 59.95,
                "å‰ä¿": 2.19, "æ€¡æµ·": 0.00, "é²¤é±¼é—¨": 1.98, "è¥¿ä¸½": 8.46, "æ·±åœ³åŒ—": 19.87, 
                "å¹³æ¹–": 27.37, "å‡¤å²—": 34.16, "å¤§è¿åŒ—": 38.76, "é¾™åŸ": 44.24, "åªåœ°": 51.87,
                "ç‡•å­æ¹–": 43.76, "è‘µæ¶Œ": 51.23, "å¤§é¹": 57.39, "æ–°å¤§": 63.72
            },
            "é²¤é±¼é—¨": {
                "æœºåœºåŒ—": 53.32, "æœºåœºä¸œ": 50.31, "é»„éº»å¸ƒ": 44.54, "çŸ³å²©": 36.43, "é¾™èƒœ": 27.26, "æ°‘æ²»åŒ—": 24.43, 
                "äº”å’Œ": 22.76, "ç™½æ³¥å‘": 11.66, "å¤§è¿": 2.18, "åªå±±": 51.49, "èšé¾™": 57.98,
                "å‰ä¿": 4.17, "æ€¡æµ·": 1.98, "é²¤é±¼é—¨": 0.00, "è¥¿ä¸½": 6.49, "æ·±åœ³åŒ—": 17.89, 
                "å¹³æ¹–": 25.38, "å‡¤å²—": 32.18, "å¤§è¿åŒ—": 36.79, "é¾™åŸ": 42.27, "åªåœ°": 49.84,
                "ç‡•å­æ¹–": 41.73, "è‘µæ¶Œ": 49.10, "å¤§é¹": 55.26, "æ–°å¤§": 61.59
            },
            "è¥¿ä¸½": {
                "æœºåœºåŒ—": 46.83, "æœºåœºä¸œ": 43.83, "é»„éº»å¸ƒ": 38.05, "çŸ³å²©": 29.94, "é¾™èƒœ": 20.77, "æ°‘æ²»åŒ—": 17.94, 
                "äº”å’Œ": 15.27, "ç™½æ³¥å‘": 5.26, "å¤§è¿": 4.52, "åªå±±": 45.04, "èšé¾™": 51.49,
                "å‰ä¿": 10.65, "æ€¡æµ·": 8.46, "é²¤é±¼é—¨": 6.49, "è¥¿ä¸½": 0.00, "æ·±åœ³åŒ—": 11.41, 
                "å¹³æ¹–": 17.89, "å‡¤å²—": 24.67, "å¤§è¿åŒ—": 29.23, "é¾™åŸ": 34.83, "åªåœ°": 42.31,
                "ç‡•å­æ¹–": 34.20, "è‘µæ¶Œ": 41.67, "å¤§é¹": 47.83, "æ–°å¤§": 54.16
            },
            "æ·±åœ³åŒ—": {
                "æœºåœºåŒ—": 35.43, "æœºåœºä¸œ": 32.42, "é»„éº»å¸ƒ": 26.65, "çŸ³å²©": 18.53, "é¾™èƒœ": 9.36, "æ°‘æ²»åŒ—": 6.54, 
                "äº”å’Œ": 3.86, "ç™½æ³¥å‘": 14.22, "å¤§è¿": 15.03, "åªå±±": 40.09, "èšé¾™": 51.49,
                "å‰ä¿": 22.06, "æ€¡æµ·": 19.87, "é²¤é±¼é—¨": 17.89, "è¥¿ä¸½": 11.41, "æ·±åœ³åŒ—": 0.00, 
                "å¹³æ¹–": 3.86, "å‡¤å²—": 14.29, "å¤§è¿åŒ—": 24.38, "é¾™åŸ": 28.43, "åªåœ°": 35.92,
                "ç‡•å­æ¹–": 28.43, "è‘µæ¶Œ": 33.71, "å¤§é¹": 39.77, "æ–°å¤§": 45.99
            },
            "å¹³æ¹–": {
                "æœºåœºåŒ—": 46.59, "æœºåœºä¸œ": 43.59, "é»„éº»å¸ƒ": 37.81, "çŸ³å²©": 29.70, "é¾™èƒœ": 20.53, "æ°‘æ²»åŒ—": 17.70, 
                "äº”å’Œ": 10.35, "ç™½æ³¥å‘": 25.38, "å¤§è¿": 25.38, "åªå±±": 29.57, "èšé¾™": 36.22,
                "å‰ä¿": 34.16, "æ€¡æµ·": 32.18, "é²¤é±¼é—¨": 30.30, "è¥¿ä¸½": 24.67, "æ·±åœ³åŒ—": 14.29, 
                "å¹³æ¹–": 0.00, "å‡¤å²—": 5.48, "å¤§è¿åŒ—": 9.54, "é¾™åŸ": 17.03, "åªåœ°": 24.57,
                "ç‡•å­æ¹–": 17.03, "è‘µæ¶Œ": 24.89, "å¤§é¹": 31.12, "æ–°å¤§": 38.43
            },
            "å‡¤å²—": {
                "æœºåœºåŒ—": 46.59, "æœºåœºä¸œ": 43.59, "é»„éº»å¸ƒ": 37.81, "çŸ³å²©": 29.70, "é¾™èƒœ": 20.53, "æ°‘æ²»åŒ—": 17.70, 
                "äº”å’Œ": 15.03, "ç™½æ³¥å‘": 25.38, "å¤§è¿": 25.38, "åªå±±": 29.57, "èšé¾™": 29.81,
                "å‰ä¿": 36.35, "æ€¡æµ·": 34.16, "é²¤é±¼é—¨": 32.18, "è¥¿ä¸½": 24.67, "æ·±åœ³åŒ—": 18.89, 
                "å¹³æ¹–": 5.48, "å‡¤å²—": 0.00, "å¤§è¿åŒ—": 4.00, "é¾™åŸ": 11.54, "åªåœ°": 19.03,
                "ç‡•å­æ¹–": 11.54, "è‘µæ¶Œ": 18.83, "å¤§é¹": 24.89, "æ–°å¤§": 31.12
            },
            "å¤§è¿åŒ—": {
                "æœºåœºåŒ—": 52.08, "æœºåœºä¸œ": 49.07, "é»„éº»å¸ƒ": 43.30, "çŸ³å²©": 35.29, "é¾™èƒœ": 26.01, "æ°‘æ²»åŒ—": 23.19, 
                "äº”å’Œ": 20.51, "ç™½æ³¥å‘": 30.87, "å¤§è¿": 25.38, "åªå±±": 35.35, "èšé¾™": 40.39,
                "å‰ä¿": 40.95, "æ€¡æµ·": 38.76, "é²¤é±¼é—¨": 36.79, "è¥¿ä¸½": 29.23, "æ·±åœ³åŒ—": 24.38, 
                "å¹³æ¹–": 9.54, "å‡¤å²—": 4.00, "å¤§è¿åŒ—": 0.00, "é¾™åŸ": 7.54, "åªåœ°": 15.03,
                "ç‡•å­æ¹–": 7.54, "è‘µæ¶Œ": 14.83, "å¤§é¹": 20.90, "æ–°å¤§": 28.12
            },
            "é¾™åŸ": {
                "æœºåœºåŒ—": 56.13, "æœºåœºä¸œ": 53.13, "é»„éº»å¸ƒ": 47.35, "çŸ³å²©": 39.24, "é¾™èƒœ": 29.19, "æ°‘æ²»åŒ—": 27.24, 
                "äº”å’Œ": 24.57, "ç™½æ³¥å‘": 35.92, "å¤§è¿": 40.39, "åªå±±": 47.88, "èšé¾™": 54.09,
                "å‰ä¿": 46.44, "æ€¡æµ·": 44.24, "é²¤é±¼é—¨": 42.27, "è¥¿ä¸½": 34.83, "æ·±åœ³åŒ—": 28.43, 
                "å¹³æ¹–": 17.03, "å‡¤å²—": 11.54, "å¤§è¿åŒ—": 7.54, "é¾™åŸ": 0.00, "åªåœ°": 7.49,
                "ç‡•å­æ¹–": 0.00, "è‘µæ¶Œ": 7.49, "å¤§é¹": 13.66, "æ–°å¤§": 20.90
            },
            "åªåœ°": {
                "æœºåœºåŒ—": 63.62, "æœºåœºä¸œ": 60.61, "é»„éº»å¸ƒ": 54.84, "çŸ³å²©": 47.53, "é¾™èƒœ": 37.47, "æ°‘æ²»åŒ—": 34.73, 
                "äº”å’Œ": 32.06, "ç™½æ³¥å‘": 43.71, "å¤§è¿": 48.27, "åªå±±": 55.77, "èšé¾™": 63.80,
                "å‰ä¿": 54.09, "æ€¡æµ·": 51.87, "é²¤é±¼é—¨": 49.84, "è¥¿ä¸½": 42.31, "æ·±åœ³åŒ—": 35.92, 
                "å¹³æ¹–": 24.57, "å‡¤å²—": 19.03, "å¤§è¿åŒ—": 15.03, "é¾™åŸ": 7.49, "åªåœ°": 0.00,
                "ç‡•å­æ¹–": 7.49, "è‘µæ¶Œ": 14.96, "å¤§é¹": 21.13, "æ–°å¤§": 28.39
            },
            "ç‡•å­æ¹–": {
                "æœºåœºåŒ—": 67.46, "æœºåœºä¸œ": 64.46, "é»„éº»å¸ƒ": 47.35, "çŸ³å²©": 40.23, "é¾™èƒœ": 27.24, "æ°‘æ²»åŒ—": 27.24, 
                "äº”å’Œ": 24.57, "ç™½æ³¥å‘": 36.22, "å¤§è¿": 40.39, "åªå±±": 40.23, "èšé¾™": 46.61,
                "å‰ä¿": 46.33, "æ€¡æµ·": 43.76, "é²¤é±¼é—¨": 41.73, "è¥¿ä¸½": 34.20, "æ·±åœ³åŒ—": 28.43, 
                "å¹³æ¹–": 17.03, "å‡¤å²—": 11.54, "å¤§è¿åŒ—": 7.54, "é¾™åŸ": 0.00, "åªåœ°": 7.49,
                "ç‡•å­æ¹–": 0.00, "è‘µæ¶Œ": 7.49, "å¤§é¹": 13.66, "æ–°å¤§": 20.90
            },
            "è‘µæ¶Œ": {
                "æœºåœºåŒ—": 73.69, "æœºåœºä¸œ": 70.69, "é»„éº»å¸ƒ": 52.63, "çŸ³å²©": 44.52, "é¾™èƒœ": 35.35, "æ°‘æ²»åŒ—": 35.35, 
                "äº”å’Œ": 32.52, "ç™½æ³¥å‘": 44.30, "å¤§è¿": 50.36, "åªå±±": 48.31, "èšé¾™": 54.69,
                "å‰ä¿": 53.80, "æ€¡æµ·": 51.23, "é²¤é±¼é—¨": 49.10, "è¥¿ä¸½": 41.67, "æ·±åœ³åŒ—": 33.71, 
                "å¹³æ¹–": 29.85, "å‡¤å²—": 18.83, "å¤§è¿åŒ—": 14.83, "é¾™åŸ": 7.49, "åªåœ°": 14.96,
                "ç‡•å­æ¹–": 7.49, "è‘µæ¶Œ": 0.00, "å¤§é¹": 6.23, "æ–°å¤§": 13.55
            },
            "å¤§é¹": {
                "æœºåœºåŒ—": 81.01, "æœºåœºä¸œ": 78.00, "é»„éº»å¸ƒ": 58.69, "çŸ³å²©": 50.57, "é¾™èƒœ": 41.40, "æ°‘æ²»åŒ—": 41.40, 
                "äº”å’Œ": 38.58, "ç™½æ³¥å‘": 50.36, "å¤§è¿": 56.80, "åªå±±": 54.37, "èšé¾™": 59.96,
                "å‰ä¿": 59.96, "æ€¡æµ·": 57.39, "é²¤é±¼é—¨": 55.26, "è¥¿ä¸½": 47.83, "æ·±åœ³åŒ—": 39.77, 
                "å¹³æ¹–": 31.12, "å‡¤å²—": 24.89, "å¤§è¿åŒ—": 20.90, "é¾™åŸ": 13.66, "åªåœ°": 21.13,
                "ç‡•å­æ¹–": 13.66, "è‘µæ¶Œ": 6.23, "å¤§é¹": 0.00, "æ–°å¤§": 7.59
            },
            "æ–°å¤§": {
                "æœºåœºåŒ—": 88.60, "æœºåœºä¸œ": 85.59, "é»„éº»å¸ƒ": 64.92, "çŸ³å²©": 56.80, "é¾™èƒœ": 47.63, "æ°‘æ²»åŒ—": 47.63, 
                "äº”å’Œ": 44.80, "ç™½æ³¥å‘": 56.69, "å¤§è¿": 60.70, "åªå±±": 60.70, "èšé¾™": 66.29,
                "å‰ä¿": 66.29, "æ€¡æµ·": 63.72, "é²¤é±¼é—¨": 61.59, "è¥¿ä¸½": 54.16, "æ·±åœ³åŒ—": 45.99, 
                "å¹³æ¹–": 38.43, "å‡¤å²—": 31.12, "å¤§è¿åŒ—": 28.12, "é¾™åŸ": 20.90, "åªåœ°": 28.39,
                "ç‡•å­æ¹–": 20.90, "è‘µæ¶Œ": 13.55, "å¤§é¹": 7.59, "æ–°å¤§": 0.00
            }
        }
    
    def _setup_ui(self) -> None:
        """æ„å»ºGUIç•Œé¢ç»„ä»¶"""
        # æ ‡é¢˜æ ‡ç­¾
        title_label = tk.Label(
            self.root, 
            text="æ·±åœ³éƒ½å¸‚åœˆåŸé™…é“è·¯é‡Œç¨‹ä¸ç¥¨ä»·æŸ¥è¯¢",
            font=("å¾®è½¯é›…é»‘", 14, "bold"),
            fg="#2c3e50"
        )
        title_label.grid(row=0, column=0, columnspan=4, pady=15)
        
        # èµ·ç‚¹åŒºåŸŸï¼šçº¿è·¯+ç«™ç‚¹é€‰æ‹©
        start_line_label = tk.Label(self.root, text="èµ·ç‚¹çº¿è·¯ï¼š", font=("å¾®è½¯é›…é»‘", 11), fg="#34495e")
        start_line_label.grid(row=1, column=0, padx=(30, 5), pady=10, sticky="w")
        self.start_line_combo = ttk.Combobox(
            self.root, textvariable=self.start_line_var,
            values=list(self.lines.keys()), width=15, font=("å¾®è½¯é›…é»‘", 10)
        )
        self.start_line_combo.grid(row=1, column=1, padx=5, pady=10, sticky="w")
        self.start_line_combo.current(0)
        self.start_line_combo.bind("<<ComboboxSelected>>", self._update_start_stations)
        
        start_station_label = tk.Label(self.root, text="èµ·ç‚¹ç«™ï¼š", font=("å¾®è½¯é›…é»‘", 11), fg="#34495e")
        start_station_label.grid(row=1, column=2, padx=(30, 5), pady=10, sticky="w")
        self.start_station_combo = ttk.Combobox(
            self.root, textvariable=self.start_var, width=20, font=("å¾®è½¯é›…é»‘", 10)
        )
        self.start_station_combo.grid(row=1, column=3, padx=(5, 30), pady=10, sticky="w")
        self._update_start_stations()  # åˆå§‹åŒ–èµ·ç‚¹ç«™é€‰é¡¹
        
        # ç»ˆç‚¹åŒºåŸŸï¼šçº¿è·¯+ç«™ç‚¹é€‰æ‹©
        end_line_label = tk.Label(self.root, text="ç»ˆç‚¹çº¿è·¯ï¼š", font=("å¾®è½¯é›…é»‘", 11), fg="#34495e")
        end_line_label.grid(row=2, column=0, padx=(30, 5), pady=10, sticky="w")
        self.end_line_combo = ttk.Combobox(
            self.root, textvariable=self.end_line_var,
            values=list(self.lines.keys()), width=15, font=("å¾®è½¯é›…é»‘", 10)
        )
        self.end_line_combo.grid(row=2, column=1, padx=5, pady=10, sticky="w")
        self.end_line_combo.current(1)
        self.end_line_combo.bind("<<ComboboxSelected>>", self._update_end_stations)
        
        end_station_label = tk.Label(self.root, text="ç»ˆç‚¹ç«™ï¼š", font=("å¾®è½¯é›…é»‘", 11), fg="#34495e")
        end_station_label.grid(row=2, column=2, padx=(30, 5), pady=10, sticky="w")
        self.end_station_combo = ttk.Combobox(
            self.root, textvariable=self.end_var, width=20, font=("å¾®è½¯é›…é»‘", 10)
        )
        self.end_station_combo.grid(row=2, column=3, padx=(5, 30), pady=10, sticky="w")
        self._update_end_stations()  # åˆå§‹åŒ–ç»ˆç‚¹ç«™é€‰é¡¹
        
        # åŠŸèƒ½æŒ‰é’®ï¼šæŸ¥è¯¢+è®¾ç½®
        query_btn = tk.Button(
            self.root, text="æŸ¥è¯¢", command=self._on_query,
            font=("å¾®è½¯é›…é»‘", 11, "bold"), bg="#34495e", fg="white",
            width=12, relief=tk.RAISED, activebackground="#2c3e50"
        )
        query_btn.grid(row=3, column=1, pady=10, sticky="e")
        
        setting_btn = tk.Button(
            self.root, text="è®¾ç½®ç¥¨ä»·è§„åˆ™", command=self._open_setting_window,
            font=("å¾®è½¯é›…é»‘", 11, "bold"), bg="#27ae60", fg="white",
            width=12, relief=tk.RAISED, activebackground="#2ecc71"
        )
        setting_btn.grid(row=3, column=2, pady=10, sticky="w", padx=(20, 0))
        
        # ç»“æœæ˜¾ç¤ºåŒºåŸŸ
        result_title = tk.Label(
            self.root, text="æŸ¥è¯¢ç»“æœ", font=("å¾®è½¯é›…é»‘", 11, "bold"), fg="#2c3e50"
        )
        result_title.grid(row=4, column=0, columnspan=4, padx=30, sticky="w", pady=(5, 0))
        
        self.result_text = scrolledtext.ScrolledText(
            self.root, width=85, height=10, font=("å¾®è½¯é›…é»‘", 10),
            bg="#f8f9fa", fg="#2c3e50", relief=tk.SUNKEN, wrap=tk.WORD
        )
        self.result_text.grid(row=5, column=0, columnspan=4, padx=30, pady=10)
        
        # ç‰ˆæƒä¿¡æ¯
        copyright_label = tk.Label(
            self.root, text="Produced by Vektorim", font=("Arial", 10, "italic"), fg="#7f8c8d"
        )
        copyright_label.grid(row=6, column=0, columnspan=4, pady=(0, 15))
    
    def _update_start_stations(self, event=None):
        """æ ¹æ®é€‰æ‹©çš„èµ·ç‚¹çº¿è·¯ï¼Œæ›´æ–°èµ·ç‚¹ç«™ä¸‹æ‹‰æ¡†"""
        selected_line = self.start_line_var.get()
        stations = self.lines[selected_line]
        self.start_station_combo["values"] = stations
        self.start_station_combo.current(0)
    
    def _update_end_stations(self, event=None):
        """æ ¹æ®é€‰æ‹©çš„ç»ˆç‚¹çº¿è·¯ï¼Œæ›´æ–°ç»ˆç‚¹ç«™ä¸‹æ‹‰æ¡†"""
        selected_line = self.end_line_var.get()
        stations = self.lines[selected_line]
        self.end_station_combo["values"] = stations
        self.end_station_combo.current(0)
    
    def _open_setting_window(self):
        """æ‰“å¼€ç¥¨ä»·è§„åˆ™è®¾ç½®çª—å£"""
        settingWindow(self)
    
    def _calculate_fare(self, distance: float, rate: float, min_fare: int) -> int:
        """è®¡ç®—ç¥¨ä»·ï¼ˆå››èˆäº”å…¥å–æ•´ï¼Œä¸ä½äºæœ€ä½ç¥¨ä»·ï¼‰"""
        fare = distance * rate
        return max(round(fare), min_fare)
    
    def _on_query(self):
        """æŸ¥è¯¢æŒ‰é’®ç‚¹å‡»äº‹ä»¶"""
        start = self.start_var.get().strip()
        end = self.end_var.get().strip()
        
        # è¾“å…¥éªŒè¯
        if start == end:
            self._show_result(f"âš ï¸  èµ·ç‚¹ç«™å’Œç»ˆç‚¹ç«™ä¸èƒ½ç›¸åŒï¼ˆ{start}ï¼‰ï¼", "red")
            return
        if start not in self.station_distances or end not in self.station_distances[start]:
            self._show_result(f"âš ï¸  æœªæ‰¾åˆ° {start} â†’ {end} çš„çº¿è·¯æ•°æ®ï¼", "red")
            return
        
        # è®¡ç®—è·ç¦»å’Œç¥¨ä»·
        distance = self.station_distances[start][end]
        fare1 = self._calculate_fare(distance, self.fare_standards[0]["rate"], self.fare_standards[0]["min_fare"])
        fare2 = self._calculate_fare(distance, self.fare_standards[1]["rate"], self.fare_standards[1]["min_fare"])
        
        # æ ¼å¼åŒ–ç»“æœ
        result = f"âœ…  æŸ¥è¯¢æˆåŠŸï¼š{start} â†’ {end}\n"
        result += f"ğŸ“  é‡Œç¨‹ï¼š{distance:.2f} å…¬é‡Œ\n"
        result += f"ğŸ’°  {self.fare_standards[0]['desc']}ï¼ˆå–æ•´åï¼‰ï¼š{fare1} å…ƒ\n"
        result += f"ğŸ’°  {self.fare_standards[1]['desc']}ï¼ˆå–æ•´åï¼‰ï¼š{fare2} å…ƒ\n"
        self._show_result(result, "green")
    
    def _show_result(self, content: str, color: str = "black"):
        """åœ¨ç»“æœæ¡†æ˜¾ç¤ºå†…å®¹"""
        self.result_text.delete(1.0, tk.END)
        self.result_text.insert(tk.END, content)
        self.result_text.tag_configure("color", foreground=color)
        self.result_text.tag_add("color", 1.0, tk.END)

    def _open_setting_window(self):
        """æ‰“å¼€ç¥¨ä»·è§„åˆ™è®¾ç½®çª—å£ï¼ˆä¿®æ”¹å‚æ•°ä¼ é€’ï¼‰"""
        settingWindow(self.root, self)  # ä¼ å…¥ä¸»çª—å£rootå’Œå½“å‰ç±»å®ä¾‹self

class settingWindow(tk.Toplevel):
    """ç¥¨ä»·è§„åˆ™è®¾ç½®çª—å£ï¼ˆå½»åº•ä¿®å¤å¸ƒå±€å’Œå‚æ•°ä¼ é€’é—®é¢˜ï¼‰"""
    def __init__(self, master, parent):  # æ–°å¢masterå‚æ•°ï¼ˆä¸»çª—å£ï¼‰ï¼Œparentä¸ºShenzhenIntercityQueryå®ä¾‹
        super().__init__(master)  # ç”¨ä¸»çª—å£ä½œä¸ºToplevelçš„çˆ¶ç»„ä»¶
        self.parent = parent  # ä¿ç•™çˆ¶ç±»å®ä¾‹ï¼Œç”¨äºæ›´æ–°ç¥¨ä»·è§„åˆ™
        self.title("ç¥¨ä»·è§„åˆ™è®¾ç½®")
        self.geometry("450x320")  # æ‰©å¤§çª—å£å°ºå¯¸ï¼Œé¿å…ç»„ä»¶æ‹¥æŒ¤
        self.resizable(False, False)
        
        # ç›´æ¥ä»çˆ¶ç»„ä»¶è·å–ç¥¨ä»·æ ‡å‡†ï¼Œé¿å…æ‹·è´é”™è¯¯
        self.rate1_var = tk.StringVar(value=str(parent.fare_standards[0]["rate"]))
        self.min1_var = tk.StringVar(value=str(parent.fare_standards[0]["min_fare"]))
        self.rate2_var = tk.StringVar(value=str(parent.fare_standards[1]["rate"]))
        self.min2_var = tk.StringVar(value=str(parent.fare_standards[1]["min_fare"]))
        
        # ç›´æ¥ä»çˆ¶ç»„ä»¶è·å–ç¥¨ä»·æ ‡å‡†ï¼Œé¿å…æ‹·è´é”™è¯¯
        self.rate1_var = tk.StringVar(value=str(parent.fare_standards[0]["rate"]))
        self.min1_var = tk.StringVar(value=str(parent.fare_standards[0]["min_fare"]))
        self.rate2_var = tk.StringVar(value=str(parent.fare_standards[1]["rate"]))
        self.min2_var = tk.StringVar(value=str(parent.fare_standards[1]["min_fare"]))
        
        # æ ‡é¢˜
        title = tk.Label(
            self, text="è°ƒæ•´ç¥¨ä»·è§„åˆ™ä¸æœ€ä½ç¥¨ä»·", font=("å¾®è½¯é›…é»‘", 12, "bold"), fg="#2c3e50"
        )
        title.grid(row=0, column=0, columnspan=3, pady=20)
        
        # ç¥¨ä»·æ ‡å‡†1è®¾ç½®ï¼ˆç®€åŒ–åˆ—å¸ƒå±€ï¼š0=æ ‡ç­¾ï¼Œ1=è¾“å…¥æ¡†ï¼Œ2=å•ä½ï¼‰
        self._add_setting_row(1, "æ ‡å‡†1", self.rate1_var, self.min1_var)
        # ç¥¨ä»·æ ‡å‡†2è®¾ç½®
        self._add_setting_row(2, "æ ‡å‡†2", self.rate2_var, self.min2_var)
        
        # ä¿å­˜æŒ‰é’®
        save_btn = tk.Button(
            self, text="ä¿å­˜è®¾ç½®", command=self._save,
            font=("å¾®è½¯é›…é»‘", 11, "bold"), bg="#27ae60", fg="white",
            width=15, relief=tk.RAISED, activebackground="#2ecc71"
        )
        save_btn.grid(row=3, column=0, columnspan=3, pady=25)
    
    def _add_setting_row(self, row: int, label_text: str, rate_var: tk.StringVar, min_var: tk.StringVar):
        """æ·»åŠ ä¸€è¡Œè®¾ç½®ï¼ˆ3åˆ—å¸ƒå±€ï¼Œé¿å…åˆ—æ•°æº¢å‡ºï¼‰"""
        # æ ‡å‡†æ ‡ç­¾
        label = tk.Label(self, text=f"{label_text}ï¼š", font=("å¾®è½¯é›…é»‘", 10), fg="#34495e")
        label.grid(row=row, column=0, padx=(40, 10), pady=10, sticky="w")
        
        # è´¹ç‡è¾“å…¥åŒºï¼ˆè¾“å…¥æ¡†+å•ä½ï¼‰
        rate_entry = tk.Entry(self, textvariable=rate_var, width=10, font=("å¾®è½¯é›…é»‘", 10))
        rate_entry.grid(row=row, column=1, padx=5, pady=10, sticky="w")
        rate_unit = tk.Label(self, text="å…ƒ/å…¬é‡Œ", font=("å¾®è½¯é›…é»‘", 9), fg="#7f8c8d")
        rate_unit.grid(row=row, column=1, padx=(90, 0), pady=10, sticky="w")
        
        # æœ€ä½ç¥¨ä»·è¾“å…¥åŒºï¼ˆè¾“å…¥æ¡†+å•ä½ï¼‰
        min_entry = tk.Entry(self, textvariable=min_var, width=8, font=("å¾®è½¯é›…é»‘", 10))
        min_entry.grid(row=row, column=2, padx=(20, 5), pady=10, sticky="w")
        min_unit = tk.Label(self, text="å…ƒï¼ˆæœ€ä½ï¼‰", font=("å¾®è½¯é›…é»‘", 9), fg="#7f8c8d")
        min_unit.grid(row=row, column=2, padx=(80, 0), pady=10, sticky="w")
    
    def _save(self):
        """ä¿å­˜è®¾ç½®ï¼ˆç®€åŒ–é€»è¾‘ï¼Œç›´æ¥è¯»å–å˜é‡ï¼‰"""
        try:
            rate1 = float(self.rate1_var.get().strip())
            min1 = int(self.min1_var.get().strip())
            rate2 = float(self.rate2_var.get().strip())
            min2 = int(self.min2_var.get().strip())
            
            # éªŒè¯æ­£æ•°
            if rate1 <= 0 or rate2 <= 0 or min1 <= 0 or min2 <= 0:
                raise ValueError("è´¹ç‡å’Œæœ€ä½ç¥¨ä»·å¿…é¡»ä¸ºæ­£æ•°")
            
            # æ›´æ–°çˆ¶ç»„ä»¶çš„ç¥¨ä»·è§„åˆ™
            self.parent.fare_standards = [
                {"rate": rate1, "min_fare": min1, "desc": f"{rate1}å…ƒ/å…¬é‡Œï¼ˆæœ€ä½{min1}å…ƒï¼‰"},
                {"rate": rate2, "min_fare": min2, "desc": f"{rate2}å…ƒ/å…¬é‡Œï¼ˆæœ€ä½{min2}å…ƒï¼‰"}
            ]
            
            messagebox.showinfo("æˆåŠŸ", "ç¥¨ä»·è§„åˆ™å·²æ›´æ–°ï¼")
            self.destroy()
        except ValueError as e:
            messagebox.showerror("è¾“å…¥é”™è¯¯", f"è¯·è¾“å…¥æœ‰æ•ˆæ•°å€¼ï¼š{str(e)}")

# ç¨‹åºå…¥å£
if __name__ == "__main__":
    root = tk.Tk()
    app = ShenzhenIntercityQuery(root)
    root.mainloop()